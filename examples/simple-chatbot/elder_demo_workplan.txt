Simple-Chatbot (Pipecat) â€“ Kaizen Work Plan
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Gemini Bot Context & API Logic
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ This project uses the **Gemini Multimodal Live** bot as the backend LLM.
â€¢ All conversation, function-calling, and language handling is routed through Gemini.
â€¢ The backend (bot-gemini.py) initializes GeminiMultimodalLiveLLMService with:
    â€“ Hebrew voice (e.g., "Lior")
    â€“ Function tool declarations (for profile, reminders, RAG)
    â€“ Streaming audio and transcript events
â€¢ Function-calling is handled per the Gemini API: the model returns a function_call object, the backend executes the function, and the result is sent back as a new message.
â€¢ The AI worker must:
    â€“ Understand the Gemini API flow (prompt â†’ function_call â†’ result â†’ response)
    â€“ Ensure all function/tool logic is compatible with Gemini's function-calling schema
    â€“ Ensure all language and TTS/ASR settings are set for Hebrew
    â€“ Validate that the backend and client interact with Gemini as described

Goal
â”€â”€â”€â”€
Create a demo-ready voice assistant for Hebrew-speaking elderly users that runs on:
â€¢ Existing Python FastAPI + Gemini-Live backend
â€¢ Existing Android RTVI client

Key MVP Features
â€¢ Two hard-coded user profiles (name, age, city, hobbies, pill-time)
â€¢ Hebrew conversation (ASR + TTS)
â€¢ Gemini Function Calling with three tools:
  â€“ get_profile_field
  â€“ set_medicine_reminder
  â€“ lookup_doc (mini RAG)
â€¢ Live Hebrew transcripts on the Android screen
â€¢ Keep current robot avatar/audio; no ElevenLabs needed

Kaizen Principles
â€¢ Small, always-green commits
â€¢ Every step has concrete visual/log validation
â€¢ Roll back or fix before moving on
â€¢ Use this file as tracker & checklist

Legend
Phase  = high-level milestone
Step   = < 30 min atomic task you can see working
Validation = CLI/log/UI check proving completion

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Meta Phase â€“ AI Harness & Validation
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
M0.1  Create scripts/validate_phase.sh dispatcher
      Validation: bash scripts/validate_phase.sh 0 prints OK

M0.2  For each phase, create scripts/validate_pX.sh
      Validation: Each script runs, prints PASS/FAIL, and exits 0/1

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Phase 0 â€“ Baseline & Branch Setup ðŸŒ±
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0.1 Create elder_demo_tracker.txt  âœ… *(auto)*
    Validation: test -f elder_demo_tracker.txt

0.2 Baseline run (English)
    â€¢ Script: scripts/validate_p0_baseline.sh
      â€“ start server on port 7860
      â€“ curl /connect
      â€“ grep log for "Bot started speaking"
    Validation: harness exits 0

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Phase 1 â€“ Profile Injection ðŸ‘µðŸ»ðŸ‘´ðŸ½
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1.1  Add profiles.py in server folder
     - Two dicts: A & B
     - Validation: python -c "import profiles; print(profiles.PROFILES.keys())" | grep a && grep b

1.2  Expose user_id in /connect
     - Modify FastAPI handler
     - Add unit test: tests/test_connect_userid.py
     - Validation: pytest -q tests/test_connect_userid.py

1.3  Inject profile into Gemini system prompt
     - Update bot-gemini.py
     - Log: "Loaded profile: Leah" or "Moshe"
     - Validation: scripts/validate_p1.sh tails log for pattern

ASK_SUPERVISOR: Please provide the Hebrew greeting text for each profile.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Phase 2 â€“ Function Calling Skeleton ðŸ› 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2.1  Define declarations (function_tools.py)
     - Validation: python -m tests.test_function_tools

2.2  Pass tools into GeminiMultimodalLiveLLMService
     - Validation: server log shows call request

2.3  Dispatcher executes Python coroutine & returns result
     - Validation: "×ž×ª×™ ×× ×™ ×œ×•×§×— ×ª×¨×•×¤×”?" triggers call & answer (log/response)

ASK_SUPERVISOR: Confirm function names, descriptions, and Hebrew phrasing for each tool.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Phase 3 â€“ Hebrew Audio ðŸŽ¤ðŸ”Š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3.1  Select Hebrew voice (e.g. "Lior")
     - Validation: hear Hebrew TTS; log shows correct voice_id

3.2  Tune VAD if needed
     - Validation: no mid-sentence cut-offs in Hebrew test phrase

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Phase 4 â€“ On-Screen Transcripts ðŸ“
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4.1  Extend VoiceClientManager state lists
     - Validation: logcat prints lines

4.2  ChatTranscript composable in UI
     - Validation: Hebrew text scrolls during chat

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Phase 5 â€“ Mini RAG ðŸ”
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
5.1  data/knowledge.json with Hebrew Q&A
     - Validation: file exists, valid JSON
5.2  lookup_doc(query) retrieval function
     - Validation: question returns snippet & source (unit test)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Phase 6 â€“ Medicine Reminder âœ…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
6.1  Add pill_taken_today flag to profile
     - Validation: profile dict updates, test reflects change
6.2  set_medicine_reminder function updates flag
     - Validation: follow-up question reflects update (log/response)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Phase 7 â€“ UX Polish & Demo Script ðŸŽ¬
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
7.1  User picker screen (Leah/Moshe)
     - Validation: UI shows both users, selection reflected in answers
7.2  Banner/Toast for latest function result
     - Validation: after tool call, banner shows summary
7.3  run_demo.sh automates server + emulator
     - Validation: script runs, demo completes without crash

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Possible Issues & Troubleshooting
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Daily API or token errors: check .env and network connectivity
â€¢ Gemini API quota or Hebrew voice not available: check API key, try fallback voice
â€¢ Android app not connecting: check backend URL, logs, and network
â€¢ Function call not triggered: check tool declaration, logs, and Gemini model support
â€¢ RAG/knowledge base not returning: check JSON validity, retrieval logic
â€¢ TTS/ASR not in Hebrew: check voice_id, language settings, and logs
â€¢ If any validation fails or requirements are unclear, the AI must PAUSE and ASK_SUPERVISOR for help before proceeding.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
End-State âœ…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Hebrew personalised conversation with transcripts
â€¢ Function calls hit Python handlers
â€¢ Knowledge lookup works; medicine reminder stateful
â€¢ Switch between User A & B proves personalisation
â€¢ Tracker empty, logs green 